 %% This is file `elsarticle-template-1-num.tex',
%%
%% Copyright 2009 Elsevier Ltd
%%
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%%
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%%
%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%%
%% $Id: elsarticle-template-1-num.tex 149 2009-10-08 05:01:15Z rishi $
%% $URL: http://lenova.river-valley.com/svn/elsbst/trunk/elsarticle-template-1-num.tex $
%%
%\documentclass[preprint,12pt]{elsarticle}
\documentclass[12pt]{iopart}
%% Use the option review to obtain double line spacing
%% \documentclass[preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% The graphicx package provides the includegraphics command.
\usepackage{graphicx}
%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{float}
%\usepackage{amsmath}
\usepackage{eqnarray}
%\usepackage{hyperref}

%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
\usepackage{lineno}
\usepackage{caption}
\captionsetup[figure]{font=small}
%\usepackage[font=small,labelfont=bf]{caption}
%\usepackage[font=small,labelfont=bf]{subcaption}
\usepackage{cite}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage[ 
    colorlinks=true,
    pdfborder={0 0 0},
    linkcolor=red
]{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}
%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

\begin{document}
%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
%% \biboptions{comma,round}

% \biboptions{}



%\journal{Journal Name}
%\tableofcontents

%\begin{frontmatter}

%% Title, authors and addresses
\title{Reducing scattered light in LIGO's third observing run.}

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}


%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

%\author{Siddharth Soni}

%\address{Louisiana State University, Louisiana, USA.}

\author{[Tentative] S. Soni$^1$, C. Austin$^1$, A. Effler$^2$, V. Frolov$^2$, J. Driggers$^4$, A. Pele$^2$, G. Gonz\'alez$^1$, R. Schofield$^{3,4}$, A. Urban$^1$, G. Valdes$^1$}\address{$^1$ Department of Physics and Astronomy, Louisiana State University, Baton Rouge, LA, 70803, USA}\address{$^2$ LIGO Livingston Observatory, Livingston, LA 70754, USA}\address{$^3$ Department of Physics, University of Oregon, Eugene, OR 97403, USA}\address{$^4$ LIGO Hanford Observatory, Richland, WA, 99352, USA} \ead{ssoni3@lsu.edu}
\begin{abstract}
%% Text of abstract

Noise due to scattered light has been one of the most frequent disturbances in the advanced LIGO detectors. Light scattering can interfere with the detection of gravitational waves. The scattering noise caused by low frequency motion can be recognized as arches in the time-frequency plane of the gravitational wave signal. In this paper, we characterize the scattering noise for LIGO's third observing run O3 from April, 2019 to March, 2020. We find at least two different populations of scattering noise and we investigate the multiple origins of one of the population as well as its mitigation. We find that relative motion between two specific surfaces is strongly correlated with the presence of scattered light and we implement a technique to reduce this motion.  We also present an algorithm using a witness channel to capture the times this noise can be present in the detector. 
%To identify the presence of the noise, we use data from sensors that monitor light transmitted through the end test masses of the detector.


\end{abstract}

%\begin{keyword}
%Science \sep Publication %\sep Complicated
%%% keywords here, in the %form: keyword \sep %keyword
%
%%% MSC codes here, in the %form: \MSC code \sep code
%%% or \MSC[2008] code %\sep code (2000 is the %default)
%
%\end{keyword}

%\end{frontmatter}

%%
%% Start line numbering here if you want
%%
%\linenumbers

%% main text
\section{Introduction}\label{introduction}
%\label{S:1}

%Maecenas \cite{Smith:2012qr}% %fermentum \cite{Smith:2013jd}% 
The LIGO  gravitational-wave observatories located at Hanford, Washington (LHO), and Livingston, Louisiana (LLO) in the USA, along with the Virgo detector in Cascina, Italy~\cite{virgo}, and the GEO 600 detector in Germany~\cite{german} are a part of a worldwide network of gravitational-wave detectors~\cite{aligo}. 
A schematic of the LIGO detectors is shown in Fig. ~\ref{fig:schematic}.
Each LIGO detector is a dual-recycled Fabry-Perot Michelson interferometer with 4 km arms. The detector acts as a transducer for strain, converting the difference in the length of arms into a signal that can be measured on a photo-diode. The output signal at the photodetectors is calibrated to an equivalent strain signal h(t) \cite{Abbott_2017,Viets_2018}.
%At the anti-symmetric end, the output mode cleaner filters the laser beam by blocking higher-order modes. Homodyne readout technique is used to read the signal at the output port \cite{Fricke_2012}. Finally, The output signal at the photodetectors is calibrated to an equivalent strain signal h(t) \cite{Abbott_2017,Viets_2018}.
%{Abbott_2017}\cite{Viets_2018}.
\begin{figure}[h]
    \centering
    \includegraphics[width=12cm]{ligo-schematic.png}
    \caption{A schematic of aLigo detectors taken from {~\cite{schematic}} }
    \label{fig:schematic}
\end{figure}


The first two observing runs, in September 2015-January 2016 and November 2016-August 2017, resulted in spectacular discoveries, including signals from the merger of 10 pairs of black holes and one from a merger of neutrons stars~\cite{catalogue,firstpaper,neturonpaper}. The third observing run, began on April 1, 2019 and ended on March, 27, 2020. During this run, plausible candidates were shared as public alerts, averaging one a week ~\cite{gracedb}. The average binary neutron star (BNS) range at Livingston and Hanford, during O3, is approximately 130 Mpc and 110 Mpc respectively. In October, 2019, a month long working break separated the first and second half of O3, called O3a and O3b respectively. An increase in the laser input power and squeezed light injection, contributed to the increase in range from O2 to O3~\cite{src,prospect}.


Noise from several different sources limits the sensitivity of the strain data at different frequencies. 
While shot noise is dominant at frequencies above 300 Hz~\cite{tjthesis}, ground motion is the major source of noise below 10 Hz which can affect the higher frequency band of the detectors. In addition to quantum noise, suspension noise and seismic noise, short duration noise transients also known as ``glitches'' can affect the sensitivity of the detectors \cite{transientpaper}. These noise transients can be due to high ground motion, electronic malfunction or other reasons, not well-understood \cite{Nuttall_2018,noisepaper,Cabero_2019}. In this paper, we focus on the type of noise transient due to scattered light which impacts the gravitational strain in 10 Hz to 120 Hz frequency band. Identifying and reducing the amount of scattering is imperative to increase the sensitivity of the detectors. 
 
The paper is composed as follows. In Sec. \ref{hardware} we give an overview of the sensors and instruments at the LIGO end stations. Next in Sec. \ref{scatteringnoise}, we discuss scattering noise and two primary methods used for its identification. Scattering noise during O3 is addressed in Sec. \ref{scatino3}. In Sec. \ref{m0r0_scattering} we provide a mathematical treatment of slow scattering, a sub-population of the light scattering and discuss the source of the noise. In Sec. \ref{rzero} we develop a method to mitigate the slow scattering noise discussed in Sec. \ref{m0r0_scattering}. Sec. \ref{transmon_scattering} introduces another source of slow scattering observed during O3. In Sec. \ref{transmonwitness} we discuss a method to identify scattering times. Finally we summarize the paper in Sec. \ref{summary}. 

\section{Hardware and sensors at LIGO end stations.}\label{hardware} In this paper, we discuss noise due to scattered light. The site of light scattering discussed in this paper, is the set of mirrors located in the end station housing. This section describes these mirrors and other hardware, crucial for an understanding of light scattering,
One of the LIGO end station housing an end test mass \cite{ETM_ref} of the interferometer arm is shown in Fig. ~\ref{fig:end_station}. Each station has a reference seismometer on the floor to monitor ambient seismic noise. The vacuum system has at the end of the 4km arms large vacuum chambers housing the test masses. The test mass and a transmitted light monitoring table are suspended from a two-stage seismic isolation table \cite{Matichard_2015}. The test mass has a double chain, four-layered suspension for additional isolation \cite{Aston_2012}. The quadruple suspension chain behind the quadruple test mass suspension is called the reaction chain. There is additional hardware around the suspension, most importantly the ``cage": a structure hard bolted to the seismic isolation table which serves both as a reference and as a safety measure for protecting against large motions that could damage the suspension.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{EndStationDiagram3.png}
    \caption{The schematic of end station housing shows the seismic isolation system, quadruple suspension, transmission motion system (TMS), and the seismometer used to measure ground vibrations. The OSEMs in the quad suspension cage measure relative motion and produce a force on the main and reaction chain. About 4 ppm of the light power in the arms is transmitted through the end test mass. $95$\% of this 4 ppm is dumped and the remaining $5$\% is split onto the two-quadrant photo-diodes (QPDs) in the TMS. These QPD's are used to check for any misalignment of the beam on the end test mass. }
    \label{fig:end_station}
\end{figure}
The suspension for the test mass uses optical shadow sensor and magnetic actuators (OSEM)  at the top three stages as well as an electrostatic drive (ESD) at the test mass stage. The OSEMs at the top stages measure relative motion and can produce a force (actuate) between the cage and the two chains. For the upper-intermediate mass (UIM) and penultimate (PUM) mass stages, the OSEMs measure and actuate in-between the two chains. The ESD is formed by the installation of 5 gold traces on reaction mass \cite{esd_schematic}. Applying a voltage on the gold traces, an electrostatic force can drive the test mass.  The reaction mass is a hollow cylinder to allow the transmitted beam to pass without encountering additional optical surfaces \cite{aerm_schematic}.

The transmission monitor is a double suspension with OSEM's at the top stage, measuring motion with respect to its cage \cite{Barsotti_2010}. It houses a telescope to reduce the large beam size coming from the arm. The LIGO end test masses have a transmission of approximately 4ppm, so for an arm power of 250kW as in O3a for the Livingston detector, the transmitted beam would be about 1W. $95\%$ of this light is dumped and $5\%$ is split about equally between two quadrant photodiodes, named A and B. 

In order to keep the optical cavities in the arms on resonance, LIGO uses the interferometric signal at the detector output to sense the difference in the arm length. It then feeds back that signal to one of the end test masses, at different stages of the quadruple suspension, with a bandwidth of about 60 Hz \cite{Martynov_2016}. As a result, the test mass chain moves much more relative to the local surfaces, since it has to ``account" for the motion of all other test masses. The main pendulum frequency of the quadruple suspension is around 0.45 Hz which means that for the drive applied at lower frequencies at upper stages, the entire chain will move together. The dominant ground motion to be fed back is indeed below this frequency. Furthermore, because most of the drive is applied in between the chains, the test mass chain moves twice as much relative to the reaction chain. The test mass motion relative to other surfaces like the transmission monitor, the cage or the vacuum chamber walls is half of the motion measured by the OSEM's at the UIM or PUM level, below 0.45 Hz.

Each LIGO detector is equipped with hundreds of thousands of auxiliary sensors, used in the feedback control system and in the environmental monitoring system. Many of these channels are not sensitive to differential arm length and are used to identify various environmental and physical couplings to the detector.
Ground motion in various frequency bands, for example, is measured by seismometers located at end stations and corner station. These seismometers record ground motion in X, Y and Z direction in the frequency range from 0.03 Hz to 30 Hz subdivided into smaller bands. Earthquakes shake the ground in $0.03-0.1$ Hz band while anthropogenic noise and ground motion due to trains show up in $1-3$ Hz region. As we discuss later, the output of these sensors is used to look for correlations with noise transients in the strain data.



 
\section{Scattering Noise}\label{scatteringnoise}
Tiny imperfections on the surfaces of test mass mirrors in the interferometer cause a small amount of light to scatter out of the main beam. This scattered light can then reflect from surfaces such as the chamber walls that are not well seismically isolated, back to the test mass. Upon recombining with the main beam, the scattered light introduces noise in the gravitational wave data. The amplitude of the noise depends on how much light recombines with the main beam, and the upper frequency depends on the relative motion.

The motion of the scatterer introduces an additional phase in the field reflected from its surface. Consider a small fraction A of the total field that gets scattered back to the main beam, from a scattering surface located behind the end test mass (ETM). This light will acquire an additional phase ${\phi}(t)$ due to the path length modulation caused by the relative motion between the end test mass and the scatterer. The resulting phase noise can be formulated as:
\begin{eqnarray}
      h_{scat} & = & \frac{{\lambda}}{4{\pi}L}A\sin({\phi}) \label{eq:1}
\end{eqnarray}

\begin{eqnarray}
    {\phi}(t) & = & \frac{4{\pi}}{{\lambda}}\left|{ x_{0} + {\delta} x_{sc}(t)}\right| \label{eq:2}
\end{eqnarray}
    
${\lambda}$ is the laser wavelength and  $\delta x_{sc}$ is the time-dependent displacement of the scattering surface which is added to the static path $x_{0}$~\cite{scatvirgo}. 
\par

\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{scatindarmlrs1.png}
    \caption{Scattering noise shows up as arches in the time-frequency spectrograms. The stacked arches suggests a scatter path that involves multiple reflections of stray light between the test mass and the scatterer.}
    \label{fig:scat}
\end{figure}

Scattering noise can be recognized as arches in time-frequency spectrograms as shown in Fig. ~\ref{fig:scat}. The peak frequency of these arches tells us the number of fringes per second and can be related to the velocity of the scatterer, $v_{sc}$ with the following relation:
\begin{equation}
    f_{\rm fringe}(t) = \left|\frac{2nv_{sc}(t)}{\lambda}\right|  \label{eq:3}
\end{equation}
where $f_{\rm fringe}(t)$ is the fringe frequency and $n$ is the number of times stray light gets reflected back and forth between the test mass and the scatterer before it joins the main beam. We can also look at the spacing of the peaks in the time domain to give us the period of the scattering surface. 
%Fig.~\ref{fig:scat} shows a scattering arch in time-frequency plane.

%Noise due to scattered light appears as an arch in time-frequency plane~\cite{omegscan}~\cite{omegscan1} as shown in  Fig.~\ref{fig:scat}. 
%During the first and second Observing runs, it was identified by measuring the motion of some of the optics that could be responsible for scattering and by looking at the output of GravitySpy which is a noise classification tool. Next, we briefly discuss these two methods.


%\subsection{GravitySpy}
% During the first and second Observing runs, scattering triggers were identified by measuring the motion of some of the optics that could be responsible for the scattering, discussed in Sec. \ref{transmon_scattering}, 
We can identify times of transients due to scattered light by looking at the output of GravitySpy.
GravitySpy is an image recognition tool that uses machine learning to classify the variety of omicron triggers that show up as transient noise in the strain data~\cite{omicron_florent,jess_thesis}. It is a citizen science project and volunteers help to generate the training dataset by assigning one of the several glitch class to the spectrogram images. The algorithm is then trained, on the time-frequency spectrograms of these labeled glitches. Based on this model training, the algorithm then classifies a new glitch into one of the several transient noise categories, scattering being one of them. Fig. \ref{fig:gspyimages}. shows three of the many glitch classes identified by GravitySpy ~\cite{gspy,gspymachine}.

\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{gspyglitch1.png}
    \caption{Time-frequency spectrograms for three different glitch classes, classified by GravitySpy. Blip glitches show up randomly in the data with no known mechanism associated. Scattering shows up during high ground motion, especially during earthquakes. Extremely Loud noise transients are associated with very high SNR and large range drops ~\cite{gspymachine}. }
    \label{fig:gspyimages}
\end{figure}



\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{scat_shelf6.png}
    \caption{ Depending on the ground motion, scattering create shelves in h(t) spectrum that are visible in the range 10 Hz to 120 Hz. The blue curve shows the h(t) spectrum for 20 seconds of data from January 6, 2020, a day with extremely high microseism compared against a quieter day. It is important to point out that data below 20 Hz is not analyzed in most gravitational wave searches and a high pass filter is applied in the frequency region around 9 Hz due to very high seismic noise at low frequencies \cite{viets_thesis}}
    \label{fig:scatshelf1}
\end{figure}
\section{Scattering in O3}\label{scatino3}
The BNS range of the detectors, which is the average astrophysical range for binary star mergers, increased to 110-140 Mpc in O3, from around 80-100 Mpc in O2~\cite{prospect} Due to this improvement in sensitivity, some of the transients of similar origin in O2 and O3 now surface with higher SNR. 
Consequently, we see a lot more scattering arches in O3. An interesting feature of scattering in O3 is the presence of two different populations of scattering glitches, so-called the ``slow'' scattering and the ``fast'' scattering. The glitch morphology of the slow scattering is the more familiar arch in time-frequency plane as shown in fig \ref{fig:slowscat}. The fast scattering triggers are more localized in time. GravitySpy currently does not distinguish between fast and slow scattering. Slow arches during O3a  typically appeared with an SNR of 15 or higher. SNR in the range of 14-16 serves as a threshold to separate the slow and fast scattering glitches in O3a. In this analysis, we have used the SNR threshold of 15 to separate the two populations of scattering glitches during O3a.

\begin{figure}[h]
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth]{slow_arch2.png}
         \caption{Slow scattering arches.}
         \label{fig:slowscat}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth]{ts_sus2.png}
         \caption{PUM stage motion during light scattering.}
         \label{fig:timeseriessus}
         
    
    \end{subfigure}
    \caption{The first image shows time-frequency representation of  slow scattering. This is an unusual number of arches due to extremely high ground motion in  $0.03$ - $0.1$ Hz (earthquake) and $0.1$ - $0.3$  Hz (microseism) band on April 5, 2019. The second image shows the PUM stage motion between the chains for the same duration. As mentioned earlier in Sec. \ref{hardware}, the PUM stage OSEM, records twice the motion in between the quad chains.}
    \label{fig:slowscat_sus}
    
\end{figure}

\subsection{Slow Scattering.}
In time-frequency spectrograms, slow scattering triggers resemble an arch.  Fig. \ref{fig:slowscat}. shows slow scattering in h(t) for a day with large ground motion. As shown in this figure, the arches have a period of $\sim$ 7 seconds, and from this we can derive the scattering surface is moving with a frequency close to 0.13 Hz ~\cite{alogsid}. 
Slow scattering is  dominant during high ground motion in $0.03$ - $0.1$ Hz (earthquake) and $0.1$ - $0.3$  Hz (microseism) band, reaching higher frequencies during larger ground motion and so it is more visible above the low frequency noise in DARM. During O3, it was particularly strong on Dec 1, 2019 and January 6, 2020 due to high levels of ground motion on both of these days at LLO.  Depending on the ground motion, slow scattering creates ``scatter shelves'' in the frequency band 10 Hz to 120 Hz in h(t) spectra as shown in Fig. \ref{fig:scatshelf1}.


% \begin{figure}[h]
%     \centering
%     \includegraphics[width=8cm]{fastscat6.png}
%     \caption{Fast scattering triggers.}
%     \label{fig:fastscat}
% \end{figure}

% \begin{figure}[h]
% \captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
%   \centering
%     \begin{subfigure}[b]{0.45\textwidth}
%         \centering
%          \includegraphics[width=\textwidth,height=4.1cm]{fast_scat8.png}
%          \caption{Fast scattering triggers.}
%          \label{fig:fastscat}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[b]{0.5\textwidth}
%         \centering
%          \includegraphics[width=\textwidth]{anthro_motion.png}
%          \caption{Anthropogenic band ground motion.}
%          \label{fig:timeseriessus}
         
    
%     \end{subfigure}
%     \caption{The first figure shows the fast scattering triggers in time-frequency plane. Each ``arch'' contains multiple sub-arches. Fast scattering triggers correlate well with high ground motion in the $1$ - $3$ Hz (anthropogenic) band. The figure on the right shows the ground motion in the $1$ - $3$ Hz band at X and Y end of the detector at LLO on Feb, 9, 2020, a day with a very high rate of fast scattering triggers. }
%     \label{fig:Fast_scattering}
    
% \end{figure}




\subsection{Fast Scattering.}
The fast scattering triggers shown in Fig. \ref{fig:fastscat} occur with a frequency $\sim$ 4 Hz in contrast to the 0.13-0.14 Hz of slow scattering arches~\cite{alogjosh}. This population of scattering correlates better with the increased ground motion in  $1$ - $3$ Hz (anthropogenic) and $0.1$ - $0.3$ (microseism) band. It is normally higher in the daytime during the weekdays. Human activity near the site and trains passing on the track near the Y end station at LLO shakes the ground in these frequency bands. 
%June 3, 2019, a day with very high ground motion in the 1-3 Hz band, registered close to 1000 triggers that resembled fast scattering. 
These triggers affect the h(t) sensitivity in the band between 10 and 50 Hz.
\begin{figure}
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \begin{minipage}{0.5\textwidth}
   \begin{subfigure}[b]{\textwidth}
        \centering
         \includegraphics[width=\textwidth,height=4cm]{fast_scat10.png}
         \caption{Fast scattering triggers.}
         \label{fig:fastscat}
    \end{subfigure}
    \end{minipage}
    \begin{minipage}{0.5\textwidth}
    \begin{subfigure}{\textwidth}
    \includegraphics[width=\textwidth,height=4cm]{anthro_motion1.png}
    \caption{Anthropogenic band ground motion.} \label{subfig:anthro}
    \end{subfigure}

    \vspace*{0.6cm}
    \begin{subfigure}{\textwidth}
    \includegraphics[width=\textwidth,height=4cm]{fast_glitchrate1.png}
    \caption{Omicron glitch rate.} \label{subfig:fast_scat_rate}
    \end{subfigure}
    \end{minipage}
    \caption{The figure on the left shows the fast scattering triggers in time-frequency plane at LLO. Each ``arch'' contains multiple sub-arches. Fast scattering triggers correlate well with high ground motion in the $1$ - $3$ Hz (anthropogenic) band. The top right figure on the right shows the ground motion in the $1$ - $3$ Hz band at X and Y end of the detector at LLO on Feb, 9, 2020. The bottom right figure shows glitch rate for omicron triggers in band 10 to 50 Hz for the same duration. }
    \label{fig:Fast_scattering}

\end{figure}

\begin{table}[h]
    \centering
    \begin{tabular}{c|c|c}
    \hline
      \textbf{Properties}   &  \textbf{Slow Scattering} & 
      \textbf{Fast Scattering}\\
      \hline
       Frequency of arches  & $<$ 0.2 Hz & $>$ 4 Hz \\
      \hline
      Median Peak Frequency & 20.6 Hz & 32.2 Hz \\
      \hline
      Median duration & 3.4 sec & 1.3 sec \\
      \hline
      Fraction of Scattering & 33.2 \% & 66.8 \% \\
       
    \hline
    \end{tabular}
    \caption{Comparison of slow and fast scattering triggers in O3a at LLO.}
    \label{tab:fastslowtab}
\end{table}{}


Table \ref{tab:fastslowtab} compares different characteristics of slow and fast Scattering triggers. The striking differences in the glitch morphology, the peak frequency, and the duration of the triggers for slow and fast scattering triggers suggest that they have a different mechanism through which the noise couples to the detector. Fig. ~\ref{fig:snrdur} shows the SNR and duration of total scattering glitches in O3a. Both distributions reveal the presence of more than one population of scattering triggers. As evident from Table.~\ref{tab:fastslowtab} slow scattering triggers tend to be longer duration compared to fast scattering triggers. We concentrate in this paper on slow scattering triggers and will not investigate fast scattering further. In the next section, we provide a detailed description of slow scattering noise at Livingston.
\begin{figure}[h]
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= 6cm]{histsnr4b.png}
         \caption{SNR distribution for scattering in O3a.}
         \label{fig:histsnr}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.5\textwidth}
        \centering
         \includegraphics[width =6cm]{histdur4b.png}
         \caption{ Duration distribution of scattering in O3a.}
         \label{fig:histdur}
         
    
    \end{subfigure}
    \caption{The SNR and duration histograms for total scattering in O3a at LLO reveal the presence of two populations the fast and slow scattering. Slow scattering tends to be louder and long duration. During notably high micro-seismic motion, there are several more slow scattering arches, that causes the third bump in the duration plot.}
    \label{fig:snrdur}
    
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{mirror-diag1.png}
    \caption{During high ground motion, the reaction chain pushes on the main chain  to keep the detector on resonance. The control is applied via coil actuators as shown in Fig. \ref{fig:end_station} and electrostatic drive as shown here. This fluctuates the distance between the two chains. A part of the light reflected back from the gold electrostatic drive joins the main beam in the arm with an additional phase. The changing difference in phase between the two beams introduces noise by causing light modulation at the dark port like a gravitational wave. Multiple bounces between the ESD trace and the end test mass show up as multiple arches in the h(t) spectrograms.}
    \label{fig:mirror_diag}
\end{figure}


\section{Slow Scattering noise at Livingston Observatory}\label{m0r0_scattering}
%Slow scattering noise pollutes the h(t) during high ground motion in $0.03$ - $0.1$ Hz and $0.1$-$0.3$ Hz band. An external drive is sent to the reaction chain to move the test mass chain to keep the detector on resonance. This creates relative motion between the end test mass (ETM) and other objects in its vicinity. 
%Due to this relative motion, any light trapped between the test mass and one of these objects can potentially introduce phase noise once it rejoins the main beam in the detector arms. 
For most of the first three aLIGO observing runs, slow scattering noise occasionally polluted the $h(t)$ spectra during periods of high ground motion in 0.1-0.3 Hz band. The characteristic scattering arches indicated that there were wavelength-scale or larger modulations of the scattering path.
As described in Sec. \ref{hardware} an external drive is applied to the test mass chain to keep the optical cavities on resonance. Because the ground moves differently at the ends of the 4 km long cavities, this drive can lead to micron-scale relative motion between the end test mass (ETM) and other objects in its vicinity, making this region a good candidate for the source of scattering arches.


%Consider specifically the relative motion between the end test mass and the annular end reaction mass (AERM).
%When a part of the light between these two mirrors is transmitted back to the arms, it interferes with the main beam. The difference in phase of the two light beams introduces phase noise in the gravitational wave channel. The information of the path length modulation between the ETM and the AERM is stored in the phase of the light between the two mirrors given by equation 2.

 
Several clues pointed specifically towards a scattering path involving the annular end reaction mass (AERM): first, the presence of several harmonics of the arches or scattering shelves (with ~$10\%$ of the power in each successive harmonic), indicated that significant fractions of the light traversed the scattered light path more than once. This eliminated several potential paths, such as to light baffles or enclosure walls, because imperfect reflections on these other paths would likely cause the loss of much more than $90\%$ of the power in each successive round trip. Second, the observation of similar harmonic series of arches at both LHO and LLO suggested that the noise was not due to an improbable alignment. And, third, micron-scale relative motions were recognized between upper stages of the test mass and reaction mass chains, suggesting that the scattering surfaces were likely between the chains. %suggesting a variation from the original design, which sought to minimize such large relative motions. 
 
The relative movement between the ETM and AERM, ${\delta x_{sc}}$ in Eq \ref{eq:2}, is not directly sensed, but at low frequencies (relative to the $.45$ Hz pendulum resonance ) the motion between the ETM and AERM is similar to motion that is sensed at the penultimate (PUM) stage of the compound pendulum. This allows us to approximate the motion between the end test mass and the reaction mass with that of PUM stage.  As shown in Fig. ~\ref{fig:fringel2} the fringe frequency of the PUM stage motion and its higher harmonics, calculated using Eq \ref{eq:3}, match scattering arches in $h(t)$ spectrograms pretty well. 

%In this case, ${\delta x_{sc}}$ is the relative movement between the ETM and AERM. Below the natural pendulum frequencies, it is similar to the relative motion between the penultimate stage (PUM) mirrors on test mass chain and reaction chain.  
%This allows us approximate the relative motion at the end stage by L2 stage motion.


%These higher harmonics of the scattering arches suggest that light is reflected multiple times between the test and reaction mass.  For these multiple reflections, we expect the total power reflecting back in the scattered field to decrease, and the rate at which this decreases is a clue to the possible source. 
\par

During operations, most of the light transmitted through the ETM, goes through the reaction mass hole and onto the other side of the reaction chain as shown in Fig.~\ref{fig:mirror_diag}. A small fraction of this Gaussian beam hits the gold trace electro-static drive (ESD), referred in Sec. \ref{hardware}, on the AERM. Due to its high reflectivity, almost all of the light is scattered back towards the test mass and a fraction $\sqrt{T_{end}}$ gets transmitted back to the arm through the ETM. This back scattered field with an additional phase shift, given by equation \ref{eq:2}, interferes with the main beam in the arms and introduces phase noise in h(t).
\par
Let $E_{0}$ be the field in the arms and $E_{asd}$ is the part of this field backscattered from the end reaction mass at the point $E_{0}$ is computed. We can calculate the total field in the arms:

\begin{eqnarray}
    E_{tot} & = & E_{0} + E_{asd} \label{eq:4} \\
    E_{asd} & = & E_{0}Ae^{i{\delta}{\phi}(t)} ,\quad A = T_{end}\sqrt{f_{r}}  \label{eq:5} \\ 
    E_{tot} & = & E_{0}[1 + Ae^{i{\delta}{\phi}(t)}]  \label{eq:6}
    %E_{tot} &= E_{0}[1 + Acos({\delta}{\phi}(t)) + Asin({\delta}{\phi}(t))]
\end{eqnarray}


The equivalent strain for this field is:
\begin{eqnarray}
     h_{sc} & = & \frac{A{\lambda}}{4{\pi}L}\sin{\delta}{\phi}  \label{eq:7}
\end{eqnarray}
   

And the effect on sensitivity can now be written as:
\begin{equation}
    h(f) = \frac{\lambda T_{end}\sqrt{f_{r}}}{8{\pi}L}\mathcal{F}\left[\sin\left(\frac{4{\pi}}{\lambda}{\delta x_{sc}(t)}\right)\right]  \label{eq:8}
\end{equation}

$T_{end}$ is the ETM amplitude transmission ($4e^{-4}$), L is the length of arms ($4$ kms), $f_{r}$ is the fraction of power reflected back from the scattering surface, and $\mathcal{F}$ is the Fourier transform of the scatterer motion \cite{vaj_scat}.
\begin{figure}[h]
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth]{fringe_l2c.png}
         \caption{PUM stage fringe frequency overlaid on h(t) scattering arches.}
         \label{fig:fringel2}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth]{spectrum_l2new.png}
         \caption{PUM stage amplitude spectral density overlaid on h(t) spectrum.}
         \label{fig:spectruml2}
         
    
    \end{subfigure}
    \caption{In the first plot, we have overlaid the multiple harmonics of the fringe frequency due to the penultimate (PUM) stage motion onto scattering arches. In the second plot, we have plotted the DARM spectrum and the spectrum calculated from the PUM stage motion using equation \ref{eq:8} with smaller and smaller values for $f_{r}$ as we match higher frequency shelves.}
    \label{fig:fringespectrum}
    
\end{figure}

The $\delta x_{sc} $ in equation \ref{eq:8} is the relative displacement between the test mass chain and the reaction chain as measured by the optical sensors on the PUM stage. 

The first shelf in the h(t) spectrum in Fig. ~\ref{fig:spectruml2} matches for $\sqrt{f_{r}} = 4e^{-4}$, roughly consistent, within an order of magnitude with a previous estimation \cite{hiro_calc}. The coefficient for second and third shelf are $5e^{-5}$ and $5e^{-6}$ respectively, about an order of magnitude reduction for each higher harmonic. We performed similar analysis for several scattering triggers and did not find significant deviations in the magnitude of these coefficients for each shelf.
\qquad



\section{Noise mitigation using suspensions control system} \label{rzero}
% \begin{figure}[h]
%     \centering
%     \includegraphics[width=5cm]{R0trackingdiagram.png}
%     \caption{A part of the drive from PUM stage is sent to the R0 stage. This decreases the relative motion between the lower stages of main and reaction chain, thereby reducing the scattered light coupling to the main beam in the detector arms.}
%     \label{fig:r0tracking}
% \end{figure} 

Scattered light due to the large relative motion between the test mass chain and reaction chain during high ground motion has adversely affected the sensitivity of the detector. 
During extremely bad microseism as witnessed on Jan 6, 2020, this relative velocity between the end test mass (ETM) and annular end reaction mass (AERM) can get as high as 25${\mu}$m/s. And for any ${\delta}x \gg {\lambda}$ there is an upconversion of the low-frequency motion of the mirrors which shows up as scattering shelves/arches with the frequency determined by equation \ref{eq:3}. In h(t) spectrograms, multiple harmonics of the scattering arches cover the frequency band 10 Hz to 120 Hz due to light reflecting between the ETM and AERM during high microseism as shown in Fig. \ref{fig:fringel2}.

One way to reduce this noise coupling is by reducing the relative motion between the ETM and AERM while keeping the intended relative motion between the ETM and the input test mass (ITM) in the arm cavity. This can be achieved by sending a part of the drive from the PUM stage and feeding it to the top stage as shown in Fig. ~\ref{fig:end_station}. This will cause the two chains to move together and hence will reduce the relative motion between them. The reaction chain ``tracks'' the main chain and we call this RC tracking ~\cite{alog_robert}.
The reduced relative motion effectively decreases the frequency at which scattering creates shelves in $h(t)$ spectrum. 

%\subsection{Reduction in  Scattering}
RC tracking was implemented on Jan 7, 2020, at LLO ~\cite{alog_anamaria}. To understand the impact of the tracking on slow scattering caused by ETM-AERM relative motion, we measured the SNR of scattering triggers and ground motion in the earthquake and microseism band between Nov 1, 2019, the start of O3b and Feb 8, 2020. We analyze triggers that are classified as scattering by Gravityspy with a confidence above 0.9. We divided this data into Pre and Post RC, where for LLO Pre RC is from Nov 1, 2019, to Jan 6, 2020, and Post R0 is from Jan 10, 2020, to Feb 8, 2020, and for LHO Pre RC is from Nov 1, 2019, to Jan 14, 2020, and Post RC is from Jan 15, 2020, to Feb 28, 2020. The analyzed data is normalized by the observing duration of Post RC considered in this study, which is $\sim 21$ days for LLO and $\sim 34$ days for LHO. Next, we considered time segments during which the ground motion in the microseismic band is similar Pre and Post RC tracking and plotted the SNR distribution of scattering triggers during these time segments. We found a clear reduction in the SNR of the scattering triggers at LLO and LHO for the Post RC scattering ~\cite{alogsid_R0}. At LLO for example, the number of triggers in the SNR bin 20-25 after RC tracking is 89, while for the same bin, before RC tracking, LLO registered 1127 scattering triggers. The SNR comparison is shown in Fig. \ref{fig:snr_r0LLO}  and Fig. \ref{fig:snr_r0LHO}.

%We used Mann-Whitney U test to compare the Pre and Post R0 data with the null hypothesis that there is no change in the ground motion and SNR of triggers [add ref]. The SNR comparison for LLO and LHO is shown in Fig.~\ref{fig:postr0_scat}.
\par
\begin{figure}[h]
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth,height=3.9cm]{snr_preandpostLLO.png}
         \caption{SNR comparison at LLO.}
         \label{fig:snr_r0LLO}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth,height=3.9cm]{snr_preandpostLHO.png}
         \caption{SNR comparison  at LHO.}
         \label{fig:snr_r0LHO}
    \end{subfigure}
    \par\bigskip
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth,height=3.9cm]{glitch_rateLLO.png}
         \caption{Glitch rate comparison at LLO.}
         
         \label{fig:rate_LLO}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth,height=3.9cm]{glitch_rateLHO.png}
         \caption{Glitch rate comparison at LHO.}
         \label{fig:rate_LHO}
    \end{subfigure}
    
    
    
    \caption{The top images compares the SNR of scattering glitches before and after RC tracking for LLO and LHO. The  SNR distribution is plotted during similar levels of before and after ground motion in the microseism band. The bottom plots compare the scattering glitch rates for different levels of microseismic ground motion before and after RC tracking. For the Pre RC tracking microseism ground motion data considered for LHO in this study, no data was found above $1500\mu{\rm m/s}$. The scattering triggers for these plots were fetched from GravitySpy with confidence above 0.9 and SNR above 10.} % second image compares the rate of scattering triggers for different levels of microseism. This shows that for similar levels of microseism above $1{\mu}m/s$, the Post R0 glitch rate (in green) is substantially lower than Pre R0 (in orange).}
    \label{fig:postr0_scat}
    
\end{figure}
We also compared the rate of scattering triggers against the microseismic ground motion for Pre and Post RC tracking. Here again, we found that for similar levels of microseism above $1\mu{\rm m/s}$, the Post R0 glitch rates are considerably lower as shown in Fig. \ref{fig:rate_LLO}. and Fig. \ref{fig:rate_LHO}~\cite{alog_corey}.


\section{Relative motion between test mass and transmitted light monitors} \label{transmon_scattering}
As mentioned in Sec. \ref{hardware}, the control drive sent to the reaction chain creates relative motion between the test mass chain and other objects in its vicinity. Relative motion between the test mass and the monitors of transmitted light is found to be another source of scattered light in DARM.
\par
 
\begin{figure}[h]
\captionsetup[subfigure]{font=scriptsize,labelfont=scriptsize}
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth]{1262389546darm_new.png}
         \caption{Scattering arches in h(t).}
         \label{fig:1262darm}
    \end{subfigure}
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth]{1262389546trans_new.png}
         \caption{Scattering arches in X end photo-diode.}
         \label{fig:1262trans}
     \end{subfigure}
     \par\bigskip
      \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth]{post_r0_darmomeg2.png}
         \caption{Scattering arches in h(t).}
         \label{fig:1265darm}
    \end{subfigure}
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width =\textwidth]{post_r0_transomeg2.png}
         \caption{Scattering arches in X end photo-diode.}
         \label{fig:1265trans}
     \end{subfigure}
     
     
    \caption{The top left plot shows scattering arches in h(t) during a day with very high microseism. Multiple reflections between the test mass and reaction mass generates the multiple harmonics. The first harmonic of the light scattering due to ETM-AERM relative motion is close to 40 Hz with higher harmonics present at $\sim$ 80 Hz, $\sim$ 120 Hz. Since the relative motion between the test mass and TMS is one-half of the ETM-AERM motion, the scattering arch due to ETM-TMS scattering is at $\sim$ 20 Hz. The top right plot shows this scattering arch in the transmitted photo-diode channel. Due to RC tracking the noise due to ETM-AERM relative motion has reduced marginally. And thus during high ground motion, only the ETM-TMS noise coupling shows up as scattering arches in h(t) and the transmitted photo-diode channel as shown in the bottom plots.}
    \label{fig:1262scat}
    
\end{figure}
During high microseism, the path length between the end test mass (ETM) and the transmission monitor system (TMS) is modulated, changing the phase of the light beam between them. This phase noise then shows up as scattering arches in both h(t) and the transmitted photo-diode channel at the same frequency. Fig. \ref{fig:1265darm} shows a  slow scattering arch in the time-frequency representation, after the RC tracking was implemented. The lack of multiple arches suggests that the scattering  path does not involve multiple traversals between the test mass and the scatterer.

%Since the dominant motion of ETM with respect to nearby objects is the DARM drive in between the quad chains, the motion between the ETM and AERM is twice the motion of the ETM (with respect to other objects like the cage, walls or TMS). 

As discussed in Sec. \ref{hardware}, the motion in between the test mass and the TMS is one-half of the motion between the chains.
Thus, the scattering shelf/arch due to ETM-TMS relative motion is observed at one-half the frequency of the scattering shelf/arch due to ETM-AERM relative motion. This can be seen in the Fig. ~\ref{fig:1262darm} where the first harmonic due to ETM-AERM scattering is at 40 Hz and the scattering arch due to ETM-TMS scattering is at 20 Hz.



The presence of scattering arches in these transmitted light monitors serves as a witness of scattering in h(t). Whenever there is relative motion between test mass chain and reaction chain, the distance between the test mass and TMS also fluctuates. These are two separate but simultaneous path length fluctuations with a common source, the test mass motion. Scattering arches due to both of these distinct path length fluctuations are thus present at the same time in h(t) albeit at different frequencies.
\par
\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{etm-transmon.png}
    \caption{The left image shows scattering shelves in X end transmitted photo-diode and h(t) before RC tracking was implemented. The scattering shelf at 10 Hz in h(t) correlates with ETM-TMS noise coupling, while the higher frequency shelves at $\sim$ 20 Hz and $\sim$ 40 Hz are due to ETM-AERM scattering. The image on the right is for a Post RC tracking scattering event and higher frequency shelves are absent in h(t) due to reduced relative motion between the main chain and the reaction chain.}
    \label{fig:etm-transmon}
\end{figure}
RC tracking does not affect the relative movement of the test mass chain with respect to the ISI cage or TMS or chamber walls. The light scattering due to ETM-TMS coupling thus remains unchanged. The scattering arch/shelf due to this noise coupling is very rarely above 10 Hz in both h(t) and transmitted photo-diode channel and is not visible above noise sources. In order to make a shelf at $f$ Hz, the relative velocity must be at least $\frac{f{\lambda}}{2}$, so for 10 Hz, we need the relative velocity between the ETM and TMS to be at least $5\mu{\rm m/s}$. This greater than 5-micron relative motion occurs during high ground motion (above $2\mu{\rm m/s}$) in $0.1$-$0.3$ Hz band ~\cite{alogsid_trans}.
%Fig.~\ref{fig:etm-transmon}. shows scattering shelf in h(t) and X end transmitted photo-diode channel due to ETM-TMS coupling during a period of high ground motion in the microseism ($0.1$-$0.3$ Hz) band.
\par

Prior to RC tracking, a scattering shelf in transmitted photo-diode channel at $f$ Hz will predict scattering shelves in h(t) at $f$ Hz due to ETM-TMS coupling and at 2$f$, 4$f$, 6$f$ and so on due to ETM-AERM coupling. Following RC tracking, a shelf in transmitted photo-diode channel at $f$ Hz only corresponds to a shelf in h(t) at the same frequency. With RC tracking the higher frequency scattering shelves due to ETM-AERM coupling have gone away. Fig. ~\ref{fig:etm-transmon}
compares the scattering shelves in h(t) and X end transmitted photo-diode channel for scattering events before and after RC tracking. 
During O3, the control drive was sent to the X end of the detector. One possible remedy to reduce the ETM-TMS relative motion is to split and apply this drive at both ends. Further reduction can be employed by making the TMS follow the test mass chain \cite{alogae_tmsx,alogsid_tmsx}. [Will include details of the ISI shaking test]
\par 

\vspace{0.5cm}
 
%TMS tracking, a technique similar to RC tracking can be employed to check the relative motion of ETM with respect to TMS \cite{alogae_tmsx,alogsid_tmsx}.
 %We performed a test during which we shook the internal seismic isolation platform at each end to study its effects on DARM. Motion at either end prompts the external drive at the X end to push on the test mass chain to mitigate the DARM length fluctuations. Shaking the Y end ISI creates a scatter shelf in Y as well as X end transmitted photo-diode, along with h(t). Moving the X end ISI does not affect the test mass motion at Y end as there is no DARM drive sent to Y end.
%Next, we implemented TMSX feedforward while shaking the X end ISI, to control the relative motion between the ETMX and TMSX. This was accomplished by sending the output of the M0 stage of the test mass chain to TMSX. TMSX tracking reduced the relative motion between the test mass chain and the TMS thereby moving the shelf to frequencies where it is no longer visible in h(t) spectra \cite{alogae_tmsx,alogsid_tmsx}. 

%\subsection{Monitoring motion of possible scattering mirrors.}\label{osems}

 

\section{Using transmitted photo-diodes to identify scattering.}\label{transmonwitness}
In Sec. \ref{scatteringnoise} we discussed GravitySpy as a method of identifying scattering glitches using machine learning.
Another way of identifying the triggers is by monitoring the motion of OSEMS and then correlating this motion with the presence of these triggers in the gravitational wave strain channel in 10 Hz - 60 Hz frequency band.

This is accomplished using an algorithm called - \textbf{gwdetchar-scattering}~\cite{alex_l_urban_2019_3526829}. An optic is considered a good witness if its motion has a strong time correlation with the scattering glitches. The list of OSEMs we look for evidence of scattering in is not constant. It is updated with channels getting added or removed based on how good a witness of scattering they are. For each sensor in this list, the gwdetchar-scattering code creates segments of the form (startime, endtime) during which the motion in optic crosses a certain frequency threshold.  The code then looks for time coincidences between these segments and glitches in h(t). Efficiency is defined as the percentage of triggers in h(t) channel that is captured by these segments while the deadtime is the duration of all the segments for an optic as a percentage of total observing time. Scattering evidence is considered to be ``strong" if the ratio of efficiency over deadtime is greater than 2 and ``weak" if it is less than 2. 


GravitySpy, even though does not provide any information with regards to where the scatterer might be located, identifies a larger subset of scattering triggers compared to that identified by motion in OSEMs. On the other hand, optics motion can be a more direct method of locating the source of scattering noise since it can identify which mirror is moving with the velocity required. It thus makes more sense to see if we can make \textbf{gwdetchar-scattering} more ``efficient'' by adding better scattering witnesses to the algorithm. In this section, we explore such a witness that can be used to identify the scattering noise. A method based on Hilbert Huang transform has also been developed to catch scattering surfaces \cite{hhtransform}.

In the last section, we showed that the transmitted photo-diode channels serve as a witness of scattering noise in h(t). Fig. ~\ref{fig:transetmx} shows a time correlation between the scattering triggers in h(t) as identified by GravitySpy and the noise in the transmitted photo-diode channel below 20 Hz. Due to the presence of this temporal coincidence of triggers, the noise in this auxiliary channel can be used to identify the scattering noise in h(t). Along with OSEM’s, these channels can be added to the list of scattering witnesses in the algorithm - \textbf{gwdetchar-scattering}.

\begin{figure}[h]
  \centering
         \includegraphics[width = 14cm,height=12cm]{htxtrb_corr2.png}
         \caption{Noise correlation between X end transmitted photo-diode and slow scattering in h(t) channel during the first three months of O3a at LLO. }
    \label{fig:transetmx}
\end{figure}

Apart from slow scattering, Extremely Loud triggers, which is another class of triggers characterized by typically high SNR also makes its way to the transmitted photo-diode channels. To differentiate the presence of slow scattering noise in h(t) from loud glitches, we can look at the frequency content of the coincident noise in the transmitted photo-diodes. The scattering noise in these witness channels appears in the range  4 - 10 Hz while the triggers coincident with loud glitches in h(t) typically appear with higher peak frequency. 

\subsection{Band-limited RMS}
To capture the scattering triggers in h(t), we use whitened band-limited root mean square (RMS) segments constructed from the raw time-series of the transmitted photo-diode channels, in the frequency band of interest. A scattering trigger in h(t) shows up as a spike in these band-limited RMS also known as blrms. By choosing a suitable threshold, we can create blrms segments and then use time coincidence with the triggers in h(t) to identify the scattering triggers. Any h(t) triggers that coincide with these band-limited segments are then written to a file as potential scattering trigger times.  This process is shown in Fig. ~\ref{fig:flow}. It is important to note that a glitch in the transmitted photo-diode channel outside the band of interest will not result in a spike and this ensures that blrms segments only catch scattering noise in h(t). Before finding time coincidence between the h(t) triggers and blrms segments, we filter the triggers by SNR (between 15 and 200) and frequency (between 10 Hz and 60 Hz), thus excluding the loud glitches that can pollute the algorithm. This is done to reduce the size of the target dataset and scattering noise occurs well within these bounds. 


\quad
\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{flow.png}
    \caption{Flowchart of the process to capture scattering in h(t) by using segments generated from whitened transmon blrms.}
    \label{fig:flow}
\end{figure}









%\subsection{Results}


%\par
We performed the analysis for O3a, from April 1, 2019, to Sep 30, 2019. The blrms segments identified 3864 h(t) triggers as scattering at LLO while GravitySpy found 3663 scattering triggers above confidence of 0.8.  Three-fourth of the GravitySpy scattering match with scattering triggers caught by blrms segments. 71$\%$ of the 3864 triggers caught by blrms segments match with GravitySpy output. This suggests that 29$\%$ of 3864 or approximately 1120 triggers are false positive with respect to GravitySpy. 
The time-frequency spectrograms of 57 randomly chosen trigger times from these 1120 triggers showed that as many as 40 of these were scattering triggers, but they were not labelled as scattering by GravitySpy above confidence of 0.8. 




\begin{figure}[h]
   \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
         \includegraphics[width= \textwidth]{transmonvetoed.png}
         \caption{}
         \label{fig:transpie}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.42\textwidth}
        \centering
         \includegraphics[width =\textwidth]{gspyvetoed.png}
         \caption{}
         \label{fig:gspypie}
         
    
    \end{subfigure}
    \caption{For O3a, the first pie chart shows that most of the triggers vetoed by  blrms segments are indeed scattering. The omega scans of the false positives show quite a few of them are scattering but were labeled with a confidence lower than 0.8 by GravitySpy. The second pie chart shows that blrms segments caught close to 75 \% of the slow scattering that GravitySpy finds above confidence of 0.8.}
    \label{fig:gspytrans}
    
\end{figure}
\par

\begin{figure}[h]
    \centering
    \includegraphics[width=10cm]{osemtransmon1.png}
    \caption{Comparing efficiency over deadtime between OSEMs and blrms segments. We can see that on all three days, transmmited photo-diode's band limited rms segments perform a better job than OSEMs in identifying slow scattering noise.}
    \label{fig:osemtrans}
\end{figure}

We also examined the performance of blrms segments against OSEMs on 3 days in O3a dominated by slow scattering noise. Fig. ~\ref{fig:osemtrans} shows the efficiency over dead time for Apr 13, 2019, May 13, 2019, and June 25, 2019. Efficiency is the percent of filtered DARM triggers that coincide with blrms segments. Deadtime refers to the total duration of the segments as a fraction of the total observing duration for that day. A large value of efficiency over deadtime is preferred as the goal is accurate identification of  noise. For all the three days, blrms segments register higher efficiency over deadtime than OSEMs scattering segments.

Blrms segments perform better than OSEMSs because they are fine tuned to catch slow scattering. The \textbf{gwdetchar-scattering} algorithm with just OSEMSs as scattering witnesses, is designed to capture the motion of optics throughout the interferometer. As discussed in earlier sections, the slow scattering noise is a result of relative motion between the end test mass and other objects in its vicinity, the reaction mass and TMS in particular. OSEMSs in the output mode cleaner or signal recycling cavity will not be sensitive to this motion. As we are aware of the potential location of scattering, we can use a more specific approach by employing the transmitted photodiode’s blrms segments to capture the noise. 


Of the two separate noise couplings mentioned in Sec. \ref{m0r0_scattering}  and Sec. \ref{transmon_scattering}, the PUM stage OSEM is sensitive to only first of these, the ETM-AERM relative motion. And in principle we expect it to identify as much noise as the blrms segments. Following RC tracking however, the scattering impact due to ETM AERM relative motion has been reduced whilst having no effect on ETM TMS noise which the PUM stage is not sensitive to. Post RC tracking slow scattering noise can thus still be identified using the blrms segments.



\newpage
\section{Summary and discussion.}\label{summary}
 Scattering noise affects the data quality as discussed in Sec. \ref{scatteringnoise} and Sec. \ref{scatino3}. Upconversion of the low-frequency noise due to large optic motion reduces the sensitivity of the detector in the high-frequency detection band. We need to use witnesses that identify times in the data when scattering noise is present as well as, when possible, identifying and eliminating the scatter mechanism in the instrument detector itself. 

We analyzed light scattering in LLO during O3 and we found the presence of two different populations of scattering noise, the slow scattering, and the fast scattering. We investigated slow scattering that appears with a typical arch shape in the time-frequency representation and we found two different paths through which this noise couples to the detector simultaneously. We were able to implement a solution for the louder noise coupling that resulted in a substantial reduction of the noise and we discussed possible remedies for the second one. 

In order to identify the times when this noise is present in the gravitational wave channel, we suggested using the band-limited time-series data of an auxiliary channel. This channel, monitors the light transmitted through the end test mass and we showed it identifies a larger subset of scattering triggers as compared to other scattering witnesses.
\par

\section{Acknowledgements} We acknowledge support from the NSF grant PHY-1806656 and PHY-1505779. For this paper we use the data from the Advanced LIGO detectors and we used the LIGO computing clusters to perform the analysis and calculations. 

  
%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% References
%%
%% Following citation commands can be used in the body text:
%% Usage of \cite is as follows:
%%   \cite{key}          ==>>  [#]
%%   \cite[chap. 2]{key} ==>>  [#, chap. 2]
%%   \citet{key}         ==>>  Author [#]

%% References with bibTeX database:

%\bibliographystyle{model1-num-names}
%\bibliography{sample.bib}

%% Authors are advised to submit their bibtex database files. They are
%% requested to list a bibtex style file in the manuscript if they do
%% not want to use model1-num-names.bst.

%% References without bibTeX database:

\newpage
\section*{References}
\bibliographystyle{unsrt}
\bibliography{sample.bib}
%\begin{thebibliography}{00}

%% \bibitem must have the following form:
%%   \bibitem{key}...
%%

%\bibitem{1}

%\end{thebibliography}
%\section{Referencess}
%\begin{itemize}
%    \item [1] Advanced Ligo LIGO-P1400177-v5
%    \item [2] Acernese F et al. (Virgo Collaboration) 015 %Class. Quant. Grav. 32 024001 (Preprint %arXiv:1408.3978)
%    \item [3]  Dooley K L et al. 2016 Class. Quant. Grav. %33 075009 (Preprint arXiv:1510.00317) URL %https://doi.org/10.1088/0264- 9381/33/7/075009
%    \item [4] AkutsuTetal.(KAGRA)2017ThestatusofKAGRAundeg%roundcryogenicgravitationalwave telescope 15th %International Conference on Topics in Astroparticle %and nderground Physics (TAUP 2017) Sudbury, Ontario, %Canada, uly 24-28, 2017 (Preprint arXiv:1710.04823)
%    
%\item [5] B. J. Meers, Phys. Rev. D 38, 2317 (1988).
%\item [6] GWTC-1: A Gravitational-Wave Transient Catalog %of Compact Binary Mergers Observed by LIGO and Virgo %during the First and Second Observing Runs. %arXiv:1811.12907
%\item [7] On the Progentor of Neutron Star Merger %GW170817.
%arxiv.1710.05838
%\item [8] Prospects for Observing and Localizing %Gravitational-Wave Transients with Advanced LIGO, dvanced %%Virgo and KAGRA arXiv:1304.0670v9
%\item [9] Detector Characterization for Advanced Ligo, %Thesis Thomas J Massinger.
%\item [9] Noise from scattered light in Virgo's second %science run data. T Accadia et al 2010 Class. Quantum %Grav. 27 194011
%\item [10] https://alog.ligo-la.caltech.edu/aLOG/index.ph%%?callRep=45053
%\end{itemize}

\end{document}

%%
%% End of file `elsarticle-template-1-num.tex'.